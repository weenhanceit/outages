<%#
  This is not a traditional Rails show page. It is a form that allows the
  user to modify aspects of the data.
%>

<h1>
  <%# FIXME: Make into in-line with edit button right-justified. %>
  <%= @outage.name %>
  <small>
    <%= link_to "Edit Outage Information",
          edit_outage_path(@outage),
          class: "btn btn-sm btn-secondary" %>
  </small>
</h1>
<%= bootstrap_form_for(@outage, builder: WeitFormBuilder) do |f| %>
  <%= f.hidden_field :active %>
  <div class="row">
    <%= f.datetime_local_field :start_time, column_width: 5 %>
    <%= f.datetime_local_field :end_time, column_width: 5 %>
  </div>
  <div class="row">
    <%= f.check_box :completed, column_width: 4 %>
    <%= f.check_box :causes_loss_of_service, column_width: 4 %>
    <%= f.check_box :watched, column_width: 4 %>
  </div>
  <div class="row">
    <%= f.text_area :description, column_width: 6 %>
    <div class="col-sm-6">
      <h4>Affected Services</h4>
      <div class="border rounded">
        <ul class="list-unstyled">
          <% @outage.cis_outages.each do |ci| %>
            <li><%= ci.name %></li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
  <!-- <div class="row">
    <div class="col">
      <%= f.primary "Save" %>
    </div>
  </div> -->

  <h2>
    History
      <%= link_to "Newest First", "#", class: "btn btn-secondary btn-sm" %>
      <%= link_to "Oldest First", "#", class: "btn btn-secondary btn-sm" %>
  </h2>

  <div class="note">
    <p class="note-header">
      New Note
    </p>
    <% @note = Note.new %>
    <%= fields_for @note do |n| %>
      <%= n.text_area :note, size: "60x6", class: "form-control" %>
      <br/>
      <%= n.button "Save Note", class: "btn btn-primary btn-sm" %>
    <% end %>
  </div>

  <ul class="list-unstyled">
    <li class="note">
      <p class="note-header">
        Larry Reid, 1 hour ago.
        <%= link_to "Edit (only if current user is original author)", "#" %>
      </p>
      <p class="note-body">
        Note 1. Some text.
      </p>
    </li>
    <li class="note">
      <p class="note-header">
        Phil Carrillo, 1 day ago.
      </p>
      <p>
        Note 2. Some other text.
      </p>
    </li>
    <li class="event">
      Start time changed by Phil Carrillo 2 days ago.
    </li>
    <li class="event">
      Not all events would show up, e.g. reminder events wouldn't be shown.
    </li>
    <li class="event">
      And we may actually want to show events that we don't currently generate events for.
    </li>
    <li class="note">
      <p class="note-header">
        Phil Carrillo, 2017-07-02.
      </p>
      <p>
        Note 3. Some other text.
      </p>
    </li>
  </ul>
<% end %>
